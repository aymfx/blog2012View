import{_ as s,c as n,o as a,N as l}from"./chunks/framework.1f285265.js";const i=JSON.parse('{"title":"pubsub-js的简单使用","description":"","frontmatter":{"title":"pubsub-js的简单使用","date":"2016-08-20T00:00:00.000Z","tags":["js"]},"headers":[],"relativePath":"posts/前端/以前/pubsub-js的简单使用.md"}'),p={name:"posts/前端/以前/pubsub-js的简单使用.md"},o=l(`<h1 id="发布与订阅" tabindex="-1">发布与订阅 <a class="header-anchor" href="#发布与订阅" aria-label="Permalink to &quot;发布与订阅&quot;">​</a></h1><blockquote><p>它是一个库，通过这个库，我们能很好的将事件事件发布出去，而不需要关心接受者是谁</p></blockquote><blockquote><p><a href="https://www.npmjs.com/package/pubsub-js" target="_blank" rel="noreferrer">https://www.npmjs.com/package/pubsub-js</a> 这是npm库</p></blockquote><blockquote><p><a href="https://github.com/mroderick/PubSubJS" target="_blank" rel="noreferrer">https://github.com/mroderick/PubSubJS</a> 这是地址</p></blockquote><h1 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h1><blockquote><p>cnpm i pubsub-js -S</p></blockquote><h1 id="我把它运用在了一个小demo配合react" tabindex="-1">我把它运用在了一个小demo配合react <a class="header-anchor" href="#我把它运用在了一个小demo配合react" aria-label="Permalink to &quot;我把它运用在了一个小demo配合react&quot;">​</a></h1><blockquote><p>这是 App.js</p></blockquote><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">React,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Component</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">logo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./logo.svg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./App.css</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Alert</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./Alert</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#FFCB6B;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">PubSub</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pubsub-js</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Button</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Component{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#FFCB6B;">constructor(props</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#FFCB6B;">super(props</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#FFCB6B;">this.state=</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">              time:</span><span style="color:#89DDFF;">false</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#FFCB6B;">this.bundEvent=this.bundEvent.bind(this</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">bundEvent</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#FFCB6B;">this.setState(prevState</span><span style="color:#A6ACCD;"> =</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;">time: </span><span style="color:#89DDFF;">!</span><span style="color:#FFCB6B;">prevState.time</span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">          if</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">this.state.time</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#FFCB6B;">PubSub.publishSync(&quot;SHOW_TIME&quot;,&quot;测试啦&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">else</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">              </span><span style="color:#FFCB6B;">PubSub.publish(&quot;HIDE_TIME&quot;,&quot;继续&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">render</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(&lt;</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">              </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">button</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">onClick={this.bundEvent</span><span style="color:#A6ACCD;">}</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;">{this.props.children}</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">/butto</span><span style="color:#A6ACCD;">n</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">/div&gt;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">App</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Component</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">render</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">div</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">className=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">App</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Alert/&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Button&gt;大时代&lt;/Button&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">/div&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">App</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><blockquote><p>这是自定义的提示，名字请忽略，没写弹窗</p></blockquote><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">React,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Component</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./App.css</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">PubSub</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pubsub-js</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#FFCB6B;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Alert</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Component</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">constructor(props</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">super(props</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">this.state=</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">flag:</span><span style="color:#82AAFF;">false</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Show(e</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">console.log(e,11</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">this.setState(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">flag:</span><span style="color:#82AAFF;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Hide(e</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">console.log(e,22</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">this.setState(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#FFCB6B;">flag:</span><span style="color:#82AAFF;">false</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">componentDidMount</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">PubSub.subscribe(&quot;SHOW_TIME&quot;,this.Show.bind(this</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">PubSub.subscribe(&quot;HIDE_TIME&quot;,this.Hide.bind(this</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">render</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">console.log(this.state.flag</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">div</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">className=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">App</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">style={{display:this.state.flag</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">block</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">none</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">}</span><span style="color:#A6ACCD;">}</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">                       </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">p&gt;测试&lt;/p&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">              </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">/div&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#FFCB6B;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Alert</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><blockquote><p>PubSub.subscribe(&quot;SHOW_TIME&quot;,this.Show.bind(this)) 这是用来订阅一个方法</p></blockquote><blockquote><p>PubSub.publish(&quot;HIDE_TIME&quot;,&quot;继续&quot;) 这就是用来发布方法的了</p></blockquote><blockquote><p>PubSub.unsubscribe() 用来取消订阅</p></blockquote><blockquote><p>对于全局都需要的弹窗和tips以及loding，我们可以用这个来改，不用每次都在局部写了</p></blockquote><h1 id="官网上提供的小栗子" tabindex="-1">官网上提供的小栗子 <a class="header-anchor" href="#官网上提供的小栗子" aria-label="Permalink to &quot;官网上提供的小栗子&quot;">​</a></h1><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Basic</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">example</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">subscribe</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">topics</span></span>
<span class="line"><span style="color:#FFCB6B;">var</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mySubscriber</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">msg,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">data</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">)</span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">console.log(</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">msg,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">data</span><span style="color:#A6ACCD;"> )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">the</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">the</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">list</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">subscribers</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">particular</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">topic</span></span>
<span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">we</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">re keeping the returned token, in order to be able to unsubscribe</span></span>
<span class="line"><span style="color:#C3E88D;">// from the topic later on</span></span>
<span class="line"><span style="color:#C3E88D;">var token = PubSub.subscribe( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">MY</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">TOPIC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, mySubscriber );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// publish a topic asyncronously</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.publish( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">MY</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">TOPIC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">world!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// publish a topic syncronously, which is faster in some environments,</span></span>
<span class="line"><span style="color:#C3E88D;">// but will get confusing when one topic triggers new topics in the</span></span>
<span class="line"><span style="color:#C3E88D;">// same execution chain</span></span>
<span class="line"><span style="color:#C3E88D;">// USE WITH CAUTION, HERE BE DRAGONS!!!</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.publishSync( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">MY</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">TOPIC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">world!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> );</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Cancel</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">specific</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">subscription</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">receive</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">the</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">topic</span></span>
<span class="line"><span style="color:#FFCB6B;">var</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mySubscriber</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">msg,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">data</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">)</span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">console.log(</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">msg,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">data</span><span style="color:#A6ACCD;"> )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">the</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">the</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">list</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">subscribers</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">particular</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">topic</span></span>
<span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">we</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">re keeping the returned token, in order to be able to unsubscribe</span></span>
<span class="line"><span style="color:#C3E88D;">// from the topic later on</span></span>
<span class="line"><span style="color:#C3E88D;">var token = PubSub.subscribe( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">MY</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">TOPIC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, mySubscriber );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// unsubscribe this subscriber from this topic</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.unsubscribe( token );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">Cancel all subscriptions for a function</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// create a function to receive the topic</span></span>
<span class="line"><span style="color:#C3E88D;">var mySubscriber = function( msg, data ){</span></span>
<span class="line"><span style="color:#C3E88D;">    console.log( msg, data );</span></span>
<span class="line"><span style="color:#C3E88D;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// unsubscribe mySubscriber from ALL topics</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.unsubscribe( mySubscriber );</span></span>
<span class="line"><span style="color:#C3E88D;">Clear all subscriptions for a topic</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">PubSub.subscribe(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, myFunc1);</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.subscribe(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a.b</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, myFunc2);</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.subscribe(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a.b.c</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, myFunc3);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">PubSub.unsubscribe(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a.b</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">);</span></span>
<span class="line"><span style="color:#C3E88D;">// no further notications for </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a.b</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> and </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a.b.c</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> topics</span></span>
<span class="line"><span style="color:#C3E88D;">// notifications for </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> will still get published</span></span>
<span class="line"><span style="color:#C3E88D;">Clear all subscriptions</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">PubSub.clearAllSubscriptions();</span></span>
<span class="line"><span style="color:#C3E88D;">// all subscriptions are removed</span></span>
<span class="line"><span style="color:#C3E88D;">Hierarchical addressing</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// create a subscriber to receive all topics from a hierarchy of topics</span></span>
<span class="line"><span style="color:#C3E88D;">var myToplevelSubscriber = function( msg, data ){</span></span>
<span class="line"><span style="color:#C3E88D;">    console.log( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">top</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">level:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, msg, data );</span></span>
<span class="line"><span style="color:#C3E88D;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// subscribe to all topics in the </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">car</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> hierarchy</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.subscribe( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">car</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, myToplevelSubscriber );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// create a subscriber to receive only leaf topic from hierarchy op topics</span></span>
<span class="line"><span style="color:#C3E88D;">var mySpecificSubscriber = function( msg, data ){</span></span>
<span class="line"><span style="color:#C3E88D;">    console.log(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">specific:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, msg, data );</span></span>
<span class="line"><span style="color:#C3E88D;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// subscribe only to </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">car.drive</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> topics</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.subscribe( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">car.drive</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, mySpecificSubscriber );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// Publish some topics</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.publish( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">car.purchase</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, { name : </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">my</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">car</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> } );</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.publish( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">car.drive</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, { speed : </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F78C6C;">14</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> } );</span></span>
<span class="line"><span style="color:#C3E88D;">PubSub.publish( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">car.sell</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">, { newOwner : </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">someone</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">else</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> } );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">// In this scenario, myToplevelSubscriber will be called for all</span></span>
<span class="line"><span style="color:#C3E88D;">// topics, three times in total</span></span>
<span class="line"><span style="color:#C3E88D;">// But, mySpecificSubscriber will only be called once, as it only</span></span>
<span class="line"><span style="color:#C3E88D;">// subscribes to the </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">car.drive</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> topic</span></span>
<span class="line"></span></code></pre></div><h1 id="tips" tabindex="-1">Tips <a class="header-anchor" href="#tips" aria-label="Permalink to &quot;Tips&quot;">​</a></h1><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Example</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">use</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">of</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">constants</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">BAD</span></span>
<span class="line"><span style="color:#FFCB6B;">PubSub.subscribe(&quot;hello&quot;,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">msg,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">data</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">)</span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">console.log(</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">data</span><span style="color:#A6ACCD;"> )</span></span>
<span class="line"><span style="color:#A6ACCD;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">PubSub.publish(&quot;helo&quot;,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">world</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">BETTER</span></span>
<span class="line"><span style="color:#FFCB6B;">var</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">MY_TOPIC</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">PubSub.subscribe(MY_TOPIC,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">msg,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">data</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">)</span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">console.log(</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">data</span><span style="color:#A6ACCD;"> )</span></span>
<span class="line"><span style="color:#A6ACCD;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">PubSub.publish(MY_TOPIC,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">world</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div>`,20),e=[o];function c(t,r,D,C,y,A){return a(),n("div",null,e)}const u=s(p,[["render",c]]);export{i as __pageData,u as default};
