<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <title>es6-Set集合与Map集合 | Aymfx&#39;s Blog</title>
  
  <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1408911_ujc2i49ntb.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">
  <link rel="stylesheet" href="/css/style.css">
</head>
  <body>
    <div class='container'>
      <header id="header">
  <section class='header-main'>
    <div class='outer'>
        <a href="/" class="logo">Aymfx's Blog</a> 
      <nav class="navbar">
        
        <a href="/" class="menu-item-link">首页</a>
        
        <a href="/archives" class="menu-item-link">归档</a>
        
        <a href="/tags" class="menu-item-link">标签</a>
        
        <a href="/about" class="menu-item-link">关于我</a>
        
        <a href="/photos" class="menu-item-link">相册</a>
        
        <a href="https://github.com/aymfx" class="menu-item-link">交友</a>
        
      </nav>
    </div>
  </section>
</header>
    <main class="main">
      <div class='post-detail'>
    <div id="toc" class='left'>
    <h4>
        文章目录
    </h4>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#前言"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Set-对象允许你存储任何类型的唯一值，无论是原始值或者是对象引用"><span class="toc-text">Set 对象允许你存储任何类型的唯一值，无论是原始值或者是对象引用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Weak-Set集合"><span class="toc-text">Weak Set集合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#创建Weak-Set集合"><span class="toc-text">创建Weak Set集合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#两者的不同"><span class="toc-text">两者的不同</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Map集合-Map-对象保存键值对。任何值-对象或者原始值-都可以作为一个键或一个值。"><span class="toc-text">Map集合  Map 对象保存键值对。任何值(对象或者原始值) 都可以作为一个键或一个值。</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WeakMap-对象是一组键-值对的集合，其中的键是弱引用的。其键必须是对象，而值可以是任意的。"><span class="toc-text">WeakMap 对象是一组键/值对的集合，其中的键是弱引用的。其键必须是对象，而值可以是任意的。</span></a></li></ol>
</div>
    <article class="post-detail animated slideInDown right">
        <div class="post-title">
          <h2 class="title">es6-Set集合与Map集合</h2>
        </div>
         <div class="post-meta"> 
          <i class='iconfont iconriqi'></i>
          <span class="post-time">2018-03-24</span>
        </div>
        <div class="article-container">
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><blockquote>
<p>离回家的时间越来越近了，突然觉得自己很差劲，分享一首歌，道出心声啊</p>
</blockquote>
<blockquote>
<p>我的博客地址 ：<a href="http://www.aymfx.cn/" target="_blank" rel="noopener">http://www.aymfx.cn/</a></p>
</blockquote>
 <a id="more"></a>   

<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=518904754&auto=1&height=66"></iframe>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">大概过去的就真的已过去</span><br><span class="line">偶尔想起还有几分怀念气息</span><br><span class="line">遇上快乐遇上心酸遇上分离</span><br><span class="line">生活终究得让人继续</span><br><span class="line">衣身太长遮住大半个身体</span><br><span class="line">学不会平淡幸福无从说起</span><br><span class="line">可到最后 原谅背叛原谅任性</span><br><span class="line">其实该原谅眼里的自己</span><br><span class="line">那年的自己讨厌的自己如今的自己</span><br><span class="line">风一直不停</span><br><span class="line">乱了旅行 残喘下去</span><br><span class="line">我除了祝福你没有其他目的</span><br><span class="line">但却害怕往事再重提</span><br><span class="line"></span><br><span class="line">大概过去的就真的已过去</span><br><span class="line">偶尔想起还有几分怀念气息</span><br><span class="line">遇上快乐遇上心酸遇上分离</span><br><span class="line">生活终究得让人继续</span><br><span class="line">衣身太长遮住大半个身体</span><br><span class="line">学不会平淡幸福无从说起</span><br><span class="line">可到最后 原谅背叛原谅任性</span><br><span class="line">其实该原谅眼里的自己</span><br><span class="line">那年的自己讨厌的自己如今的自己</span><br><span class="line">风一直不停</span><br><span class="line">乱了旅行 残喘下去</span><br><span class="line">我除了祝福你没有其他目的</span><br><span class="line">但却害怕往事再重提</span><br><span class="line">我安慰我自己 恨自己 伤感记忆</span><br><span class="line">只能用意志慢慢的去抚平冬季</span><br><span class="line">我除了祝福你没有其他目的</span><br><span class="line">我也可以带着青涩 美好回忆</span><br></pre></td></tr></table></figure>

<h3 id="Set-对象允许你存储任何类型的唯一值，无论是原始值或者是对象引用"><a href="#Set-对象允许你存储任何类型的唯一值，无论是原始值或者是对象引用" class="headerlink" title="Set 对象允许你存储任何类型的唯一值，无论是原始值或者是对象引用"></a>Set 对象允许你存储任何类型的唯一值，无论是原始值或者是对象引用</h3><blockquote>
<p>创建Set集合并添加元素,对于字符串和数字不会发生强制转换，因此时两个值</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">let set = new Set();</span><br><span class="line"></span><br><span class="line">set.add(5)</span><br><span class="line">set.add(&apos;5&apos;)</span><br><span class="line"></span><br><span class="line">console.log(set.size) //2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>对象如果做属性名的话，es5中会发生这种事</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">var set = Object.create(null);</span><br><span class="line">var obj1 = &#123;&#125;;</span><br><span class="line">var obj2 = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">set[obj1] = &apos;foo&apos;</span><br><span class="line"></span><br><span class="line">console.log(set[obj2])  //foo 因为不能识别对象他们全部转换成这个了 [object object]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let set = new Set(),</span><br><span class="line">    key1 = &#123;&#125;,</span><br><span class="line">    key2 = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">set.add(key1)</span><br><span class="line">set.add(key2)</span><br><span class="line"></span><br><span class="line">console.log(set.size) //2 说明不是调用tostring方法</span><br></pre></td></tr></table></figure>

<blockquote>
<p>set是会忽略重复值的</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let set = new Set();</span><br><span class="line">set.add(5)</span><br><span class="line">set.add(5)</span><br><span class="line">set.add(&apos;5&apos;)</span><br><span class="line">set.add(5)</span><br><span class="line"></span><br><span class="line">console.log(set.size) //2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>利用has() 检查值是否存在  清除所有元素 clear()</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">let set = new Set();</span><br><span class="line">set.add(&apos;5&apos;)</span><br><span class="line">set.add(&apos;6&apos;)</span><br><span class="line">set.add(&apos;7&apos;)</span><br><span class="line">console.log(set.has(&apos;5&apos;)) // true</span><br><span class="line">console.log(set.has(5)) //false</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">set.clear();</span><br><span class="line">console.log(set.has(&apos;6&apos;)) false</span><br></pre></td></tr></table></figure>

<blockquote>
<p>移除元素</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let set = new Set();</span><br><span class="line">set.add(&apos;5&apos;)</span><br><span class="line">set.add(&apos;6&apos;)</span><br><span class="line">console.log(set.has(&apos;5&apos;)) // true</span><br><span class="line">set.delete(&apos;5&apos;) //false</span><br><span class="line">console.log(set.has(&apos;5&apos;)) //false</span><br></pre></td></tr></table></figure>

<blockquote>
<p>使用Foreach循环,他和数组的方式的基本一样，我们来看看栗子，他们的不同</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">var arr = new Array(1,2,3,4),</span><br><span class="line">    set = new Set([1,2,3,4]);</span><br><span class="line"></span><br><span class="line">let pocess = &#123;</span><br><span class="line">    output (value,index) &#123;</span><br><span class="line">        console.log(value,index);</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    arrObj (arr) &#123;</span><br><span class="line">        arr.forEach((value,index,own) =&gt; &#123;</span><br><span class="line">            this.output(value,index);</span><br><span class="line">            console.log(arr === own);</span><br><span class="line">        &#125;,this)</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    setObj (arr) &#123;</span><br><span class="line">        arr.forEach((value,index,own) =&gt; &#123;</span><br><span class="line">            this.output(value,index);</span><br><span class="line">            console.log(arr === own);</span><br><span class="line">        &#125;,this)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pocess.arrObj(arr)</span><br><span class="line">pocess.setObj(set)</span><br><span class="line"></span><br><span class="line">//第一种结果</span><br><span class="line"></span><br><span class="line">VM163:0 1 0</span><br><span class="line">VM163:12 true</span><br><span class="line">VM163:6 2 1</span><br><span class="line">VM163:12 true</span><br><span class="line">VM163:6 3 2</span><br><span class="line">VM163:12 true</span><br><span class="line">VM163:6 4 3</span><br><span class="line">VM163:12 true</span><br><span class="line"></span><br><span class="line">//第二种结果</span><br><span class="line"></span><br><span class="line">VM173: 12 1 1</span><br><span class="line">VM173:19 true</span><br><span class="line">VM173:6 2 2</span><br><span class="line">VM173:19 true</span><br><span class="line">VM173:6 3 3</span><br><span class="line">VM173:19 true</span><br><span class="line">VM173:6 4 4</span><br><span class="line">VM173:19 true</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将Set集合转换成数组，下列演示去重</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//第一种方式</span><br><span class="line"></span><br><span class="line">let set = new Set([1,5,58,6,7,8,9,5]),</span><br><span class="line">    arr = [...set];</span><br><span class="line">console.log(arr); //[1, 5, 58, 6, 7, 8, 9]</span><br><span class="line"></span><br><span class="line">//第二种</span><br><span class="line"></span><br><span class="line">console.log(Array.from(new Set([1,5,58,6,7,8,9,5]))); // [1, 5, 58, 6, 7, 8, 9]</span><br></pre></td></tr></table></figure>

<h4 id="Weak-Set集合"><a href="#Weak-Set集合" class="headerlink" title="Weak Set集合"></a>Weak Set集合</h4><blockquote>
<p>set 是一个强引用集合，不信看栗子</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">let set = new Set(),</span><br><span class="line">    key = &#123;&#125;;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">set.add(key);</span><br><span class="line">console.log(set.size); //1</span><br><span class="line">//移除原始引用</span><br><span class="line">key = null;</span><br><span class="line"></span><br><span class="line">console.log(set.size); //1</span><br><span class="line"></span><br><span class="line">//重新取回引用</span><br><span class="line"></span><br><span class="line">key = [...set][0]; //&#123;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这种情况会造成内存的泄露，所以我们可以用以下的方法，弱引用的Set集合</p>
</blockquote>
<h4 id="创建Weak-Set集合"><a href="#创建Weak-Set集合" class="headerlink" title="创建Weak Set集合"></a>创建Weak Set集合</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let set = new WeakSet(),</span><br><span class="line">    key = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">//向集合set添加对象</span><br><span class="line">set.add(key);</span><br><span class="line">console.log(set.has(key)); //true</span><br><span class="line"></span><br><span class="line">set.delete(key)</span><br><span class="line">console.log(set.has(key)); //false</span><br></pre></td></tr></table></figure>

<blockquote>
<p>我们试试这个</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">let set = new WeakSet(),</span><br><span class="line">    key = &#123;&#125;;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">set.add(key);</span><br><span class="line">console.log(set.has(key)); //true set.size不能用在weakset</span><br><span class="line">//移除原始引用</span><br><span class="line">key = null;</span><br><span class="line"></span><br><span class="line">console.log(set.has(key)); //false</span><br></pre></td></tr></table></figure>

<h4 id="两者的不同"><a href="#两者的不同" class="headerlink" title="两者的不同"></a>两者的不同</h4><blockquote>
<p>WeakSet 对象中只能存放对象引用, 不能存放值, 而 Set 对象都可以.</p>
</blockquote>
<blockquote>
<p>WeakSet 对象中存储的对象值都是被弱引用的, 如果没有其他的变量或属性引用这个对象值, 则这个对象值会被当成垃圾回收掉. 正因为这样, WeakSet 对象是无法被枚举的, 没有办法拿到它包含的所有元素</p>
</blockquote>
<blockquote>
<p>WeakSet 不可迭代 于是 for of foreach keys() values() 方法都没有</p>
</blockquote>
<h4 id="Map集合-Map-对象保存键值对。任何值-对象或者原始值-都可以作为一个键或一个值。"><a href="#Map集合-Map-对象保存键值对。任何值-对象或者原始值-都可以作为一个键或一个值。" class="headerlink" title="Map集合  Map 对象保存键值对。任何值(对象或者原始值) 都可以作为一个键或一个值。"></a>Map集合  Map 对象保存键值对。任何值(对象或者原始值) 都可以作为一个键或一个值。</h4><blockquote>
<p>基本用法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let map = new Map(),</span><br><span class="line">    key1 = &#123;&#125;,</span><br><span class="line">    key2 = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">map.set(&apos;name&apos;,&apos;ly&apos;)</span><br><span class="line">map.set(key1,&quot;ly1&quot;)</span><br><span class="line">map.set(key2,&apos;2&apos;)</span><br><span class="line"></span><br><span class="line">console.log(map.get(&apos;name&apos;),map.get(key1),map.get(key2)); //ly ly1 2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Map集合支持的方法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">let map = new Map(),</span><br><span class="line">    key1 = &#123;&#125;,</span><br><span class="line">    key2 = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">map.set(&apos;name&apos;,&apos;ly&apos;)</span><br><span class="line">map.set(key1,&quot;ly1&quot;)</span><br><span class="line">map.set(key2,&apos;2&apos;)</span><br><span class="line"></span><br><span class="line">console.log(map.size);  //3</span><br><span class="line"></span><br><span class="line">console.log(map.has(key2)); //true</span><br><span class="line">console.log(map.get(key2));2</span><br><span class="line"></span><br><span class="line">map.delete(key2)</span><br><span class="line">console.log(map.has(key2)); //false</span><br><span class="line"></span><br><span class="line">map.clear()</span><br><span class="line">console.log(map.has(key1)); //false</span><br><span class="line">console.log(map.size);  //0</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Map集合的初始化方法,可以传一个数组，数组包含一个个子数组，子数组包含两个值，键和值</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">let map = new Map([[&quot;name&quot;,&apos;ly&apos;],[&quot;age&quot;,&apos;18&apos;]]);</span><br><span class="line"></span><br><span class="line">console.log(map.has(&apos;name&apos;)); //true</span><br><span class="line">console.log(map.get(&apos;name&apos;)); //ly</span><br><span class="line">console.log(map.size);  //2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>可以使用ForEach()</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let map = new Map([[&quot;name&quot;,&apos;ly&apos;],[&quot;age&quot;,&apos;18&apos;]]);</span><br><span class="line"></span><br><span class="line">map.forEach((value,key,own) =&gt; &#123;</span><br><span class="line">    console.log(value,key,own);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">//ly name Map(2) &#123;&quot;name&quot; =&gt; &quot;ly&quot;, &quot;age&quot; =&gt; &quot;18&quot;&#125;</span><br><span class="line"></span><br><span class="line">18 age Map(2) &#123;&quot;name&quot; =&gt; &quot;ly&quot;, &quot;age&quot; =&gt; &quot;18&quot;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="WeakMap-对象是一组键-值对的集合，其中的键是弱引用的。其键必须是对象，而值可以是任意的。"><a href="#WeakMap-对象是一组键-值对的集合，其中的键是弱引用的。其键必须是对象，而值可以是任意的。" class="headerlink" title="WeakMap 对象是一组键/值对的集合，其中的键是弱引用的。其键必须是对象，而值可以是任意的。"></a>WeakMap 对象是一组键/值对的集合，其中的键是弱引用的。其键必须是对象，而值可以是任意的。</h3><blockquote>
<p>适用场景 保存dom元素对象，便于销毁和创建</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">let map = new WeakMap(),</span><br><span class="line">    ele = document.querySelector(&apos;div&apos;)[0];</span><br><span class="line"></span><br><span class="line">map.set(ele,&apos;Original&apos;);</span><br><span class="line"></span><br><span class="line">let value = map.get(&apos;ele&apos;) </span><br><span class="line"></span><br><span class="line">console.log(value); //Original</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ele.parentNode.removeChild(ele);</span><br><span class="line"></span><br><span class="line">ele = null;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>WeakMap支持的方法</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let key1 = &#123;&#125;,</span><br><span class="line">    key2 = &#123;&#125;,</span><br><span class="line">    map = new WeakMap([[key1,&apos;ly&apos;],[key2,&apos;18&apos;]]);</span><br><span class="line">    </span><br><span class="line">    console.log(map.has(key1)); //true</span><br><span class="line">    console.log(map.get(key1)); //ly</span><br><span class="line">    map.delete(key1)</span><br><span class="line">    console.log(map.has(key1)); //false</span><br><span class="line">    console.log(map.get(key1)); //undefined</span><br></pre></td></tr></table></figure>

<blockquote>
<p>私有对象数据</p>
</blockquote>
<blockquote>
<p>es5创建接近有私有数据的对象</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var Person = (function()&#123;</span><br><span class="line">    var privateData = &#123;&#125;,</span><br><span class="line">        privateId = 0;</span><br><span class="line">    function Person(name)&#123;</span><br><span class="line">        Object.defineProperty(this,&quot;_id&quot;,&#123;value:privateId++&#125;)</span><br><span class="line">        privateData[this._id] = &#123;</span><br><span class="line">            name:name</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    Person.prototype.getName = function()&#123;</span><br><span class="line">        return privateData[this._id].name</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return Person</span><br><span class="line">&#125;())</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这种方式的弊端就是对象数据永远不会消失,而WeakUp可以处理这种情况</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">let Person = (function()&#123;</span><br><span class="line">    let privateData = new WeakMap();</span><br><span class="line">    function Person(name)&#123;</span><br><span class="line">        privateData.set(this,&#123;name:name&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    Person.prototype.getName = function()&#123;</span><br><span class="line">        return privateData.get(this).name</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return Person</span><br><span class="line">&#125;())</span><br></pre></td></tr></table></figure>







 
        </div> 
      </article> 
</div>



    </main>
    </div>
  </body>
</html>